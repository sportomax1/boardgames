<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BoardGameGeek API App</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1 style="text-align:center;">BGG Collection Analyzer</h1>
    <div style="display:flex; justify-content:space-between; align-items:flex-start; margin-bottom:1em; border:2px dashed #0078d4; border-radius:10px; padding:1em; background:#fafdff;">
        <div>
            <div style="font-weight:600; margin-bottom:0.3em;">Collection Actions</div>
            <button id="fetchBtn" class="modern-btn" aria-label="Fetch your BGG collection">Fetch Sportomax</button>
            <button id="tierRankBtn" class="modern-btn" style="margin-left: 1em;" aria-label="Start tier ranking">Tier Rank</button>
            <div style="display:inline-block; margin-left:1em;">
                <button id="downloadComboBtn" class="modern-btn" aria-label="Download current view">Download ▼</button>
                <div id="downloadDropdown" style="display:none; position:absolute; background:#fff; border:1px solid #0078d4; border-radius:5px; box-shadow:0 2px 8px rgba(0,0,0,0.12); z-index:1000; min-width:120px;">
                    <button id="downloadCsvBtn" class="modern-btn" style="width:100%; border-radius:0; border-bottom:1px solid #eee; background:#fff; color:#222; text-align:left; padding:0.5em 1em;" aria-label="Download current view as CSV">Download CSV</button>
                    <button id="downloadXlsxBtn" class="modern-btn" style="width:100%; border-radius:0 0 5px 5px; background:#fff; color:#222; text-align:left; padding:0.5em 1em;" aria-label="Download current view as XLSX">Download XLSX</button>
                </div>
            </div>
        </div>
        <div style="min-width:340px; text-align:right; font-size:1em;">
            <div style="font-weight:600; margin-bottom:0.2em;">API Timing & Collection Summary</div>
            <span id="timingInfo" aria-label="API timing info"></span>
        </div>
    </div>
    <div style="margin-bottom: 1em; text-align: center; border:2px dashed #0078d4; border-radius:10px; padding:1em; background:#fafdff;">
        <div style="font-weight:600; margin-bottom:0.3em;">View & Search Options</div>
        <div style="display:flex; flex-wrap:wrap; justify-content:center; gap:1em; align-items:center;">
            <div>
                <label for="userSelect" style="font-weight:bold; margin-right:0.5em;">User:</label>
                <select id="userSelect" class="modern-btn" style="min-width:120px; font-size:1em; padding:0.4em 1em; background:#fff; color:#222; border:1.5px solid #0078d4; border-radius:5px;">
                    <option value="sportomax">sportomax</option>
                    <option value="dtwlibrary">dtwlibrary</option>
                </select>
            </div>
            <div>
                <input type="text" id="searchInput" placeholder="Search games by name..." style="padding: 8px; width: 220px; font-size: 14px;" aria-label="Search games by name">
                <button id="clearSearchBtn" style="margin-left: 0.5em;" aria-label="Clear search">Clear</button>
                <!-- <span style="font-size:0.95em; color:#666; margin-left:0.5em;">Type to filter by game name</span> -->
            </div>
            <div>
                <div style="font-weight:bold; font-size:1.1em; margin-bottom:0.2em;">Preset Views:</div>
                <select id="presetViewsDropdown" class="modern-btn" style="min-width:260px; font-size:1em; padding:0.4em 1em; background:#fff; color:#222; border:1.5px solid #0078d4; border-radius:5px; box-shadow:0 1px 4px rgba(0,0,0,0.07);">
                    <option value="">-- Select a View --</option>
                    <option value="quick">Quick Games</option>
                    <option value="newest">New Games</option>
                    <option value="mostPlayed">Most Played Games</option>
                    <option value="bestRating">Best Rating</option>
                    <option value="wantToPlay">Want to Play (by Rating)</option>
                    <option value="wantToBuy">Want to Buy Games</option>
                    <option value="prevOwned">Prev Owned (by Bayes Avg)</option>
                    <option value="all">Show All</option>
                </select>
            </div>
            <div>
                <button id="simpleViewBtn" class="modern-btn" aria-label="Toggle simple/full table view">Simple View</button>
            </div>
        </div>
    </div>
    <div style="font-weight:600; margin-bottom:0.3em; text-align:center; border:2px dashed #0078d4; border-radius:10px; padding:0.5em 0.5em 0.7em 0.5em; background:#fafdff;">
        Main Filter Buttons
        <div style="margin:0.3em 0 0.2em 0; text-align:center;">
            <span>Filter by player count:</span>
            <span id="playerCountCheckboxes">
                <script>for(let n=1;n<=12;n++)document.write(`<label style='margin:0 2px;'><input type='checkbox' value='${n}' class='playerCountBox'/>${n}</label>`);</script>
            </span>
            <button id="applyPlayerFilterBtn" class="modern-btn" style="margin-left:0.3em;">Apply</button>
            <button id="clearPlayerFilterBtn" class="modern-btn" style="margin-left:0.3em;">Clear</button>
            <span id="selectedPlayerCounts" style="margin-left:0.7em;color:#0078d4;"></span>
        </div>
        <div id="statusFlagFilter" style="margin:0.2em 0 0.3em 0; text-align:center;">
            <span style="font-weight:bold;">Status Flags:</span>
            <label style='margin:0 4px;'><input type='checkbox' class='statusFlagBox' data-flag='own'>Own</label>
            <label style='margin:0 4px;'><input type='checkbox' class='statusFlagBox' data-flag='prevowned'>Prev Owned</label>
            <label style='margin:0 4px;'><input type='checkbox' class='statusFlagBox' data-flag='fortrade'>For Trade</label>
            <label style='margin:0 4px;'><input type='checkbox' class='statusFlagBox' data-flag='want'>Want</label>
            <label style='margin:0 4px;'><input type='checkbox' class='statusFlagBox' data-flag='wanttoplay'>Want to Play</label>
            <label style='margin:0 4px;'><input type='checkbox' class='statusFlagBox' data-flag='wanttobuy'>Want to Buy</label>
            <label style='margin:0 4px;'><input type='checkbox' class='statusFlagBox' data-flag='wishlist'>Wishlist</label>
            <label style='margin:0 4px;'>Wishlist Priority: <input type='number' min='0' max='5' value='' class='statusFlagInput' data-flag='wishlistpriority' style='width:2.5em;'></label>
            <label style='margin:0 4px;'><input type='checkbox' class='statusFlagBox' data-flag='preordered'>Preordered</label>
            <button id="applyStatusFlagBtn" class="modern-btn" style="margin-left:0.3em;">Apply</button>
            <button id="clearStatusFlagBtn" class="modern-btn" style="margin-left:0.3em;">Clear</button>
            <span id="selectedStatusFlags" style="margin-left:0.7em;color:#0078d4;"></span>
        </div>
    </div>
    <div style="font-weight:600; margin-bottom:0.3em; text-align:center; border:2px dashed #0078d4; border-radius:10px; padding:0.5em; background:#fafdff;">Games Table & Filters</div>
    <div id="results-container" style="position:relative;">
        <button id="fullscreenTableBtn" title="Toggle Fullscreen Table" style="position:absolute; top:8px; right:12px; z-index:10; background:#1976d2; color:#fff; border:none; border-radius:5px; padding:6px 14px; font-size:1.1em; cursor:pointer; box-shadow:0 2px 8px rgba(0,0,0,0.08);">⛶</button>
        <div id="results" aria-label="Games table and filters" style="border:2px dashed #0078d4; border-radius:10px; padding:1em; background:#fafdff;"></div>
    </div>
    <div id="rankingInterface" style="display: none; border:2px dashed #0078d4; border-radius:10px; padding:1em; background:#fafdff;" aria-label="Pairwise ranking interface"></div>
    <script src="app.js"></script>
</body>
</html>
